<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenue chez GuigzNFT</title>
    <button id="connect">Connect Wallet</button>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Bienvenue chez GuigzNFT</h1>
	<div class="story">
		<p>Il était une fois un éléphant rouge nommé Guigz, qui était différent des autres éléphants de sa tribu. Sa couleur unique et sa curiosité sans limite l'avaient amené à explorer le monde virtuel en quête d'opportunités pour se démarquer encore davantage.</p>
		<p>Un jour, Guigz découvrit l'univers fascinant des NFT, ou "Jetons Non Fongibles". Ce nouveau monde lui offrait la possibilité d'acheter et de vendre des œuvres d'art numériques uniques, comme des images ou des animations, chacune dotée d'une valeur spécifique. Il comprit que le succès dans cet univers reposait sur plusieurs concepts clés, notamment le stacking, le net et les cryptomonnaies.</p>
		<p>Guigz commença par apprendre le stacking. Il découvrit que cette technique consistait à cumuler des tokens, ou jetons, pour améliorer ses gains et ses avantages au sein de la communauté NFT. Il pouvait ainsi renforcer sa position et profiter d'opportunités exclusives.</p>
		<p>Le net, quant à lui, faisait référence au réseau Internet et aux plateformes en ligne où Guigz pouvait acheter, vendre ou échanger des NFTs avec d'autres amateurs. Il comprit que maîtriser cet outil était essentiel pour naviguer efficacement dans l'univers des NFT et accéder aux meilleures opportunités.</p>
		<p>Enfin, les cryptomonnaies jouaient un rôle crucial dans le monde des NFT. Guigz apprit que ces monnaies virtuelles étaient souvent utilisées pour acheter et vendre des NFT, car elles offraient sécurité et anonymat aux transactions. Il se familiarisa avec des cryptomonnaies populaires telles que l'Ethereum et le Bitcoin et apprit à les utiliser pour ses transactions.</p>
		<p>Un jour, Guigz tomba sur une image virtuelle représentant un éléphant rouge majestueux, qui lui ressemblait étrangement. Il décida d'investir dans ce NFT, qu'il baptisa GuigzNFT. Grâce à sa persévérance et à sa connaissance des concepts clés du stacking, du net et des cryptomonnaies, Guigz réussit à vendre son GuigzNFT à un prix bien supérieur à celui qu'il avait payé.</p>
		<p>Cette expérience permit à Guigz de comprendre la valeur de la différence et de l'unicité, et il continua à explorer l'univers des NFT pour partager son histoire et inspirer d'autres amateurs à embrasser leur singularité.</p>
	</div>
	<div class="container">
        <h2>Gérer vos GuigzToken</h2>
        <input type="text" id="guigzAmount" placeholder="Montant">
        <button id="depositGuigzToken">Déposer GuigzToken</button>
        <button id="withdrawGuigzToken">Retirer GuigzToken</button>

        <h2>Gérer vos WSGB</h2>
        <input type="text" id="wsgbAmount" placeholder="Montant">
        <button id="depositWSGB">Déposer WSGB</button>
        <button id="withdrawWSGB">Retirer WSGB</button>
    </div>
	<p id="balance">Solde : 0</p>
    <button id="mint">Mint NFT</button>
    <script>
        let web3;
        let accounts;
        let contract;
        let mintNFT = await contractAddress1.methods.mint(...).send({ from: accounts[0] });

        const abi1 = [
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_token",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "_tokenPrice",
				"type": "uint256"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "approved",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "ApprovalForAll",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "previousOwner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "OwnershipTransferred",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "getApproved",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			}
		],
		"name": "isApprovedForAll",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "recipient",
				"type": "address"
			}
		],
		"name": "mintNFT",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "ownerOf",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "renounceOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			},
			{
				"internalType": "bytes",
				"name": "_data",
				"type": "bytes"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "setApprovalForAll",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "bytes4",
				"name": "interfaceId",
				"type": "bytes4"
			}
		],
		"name": "supportsInterface",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "token",
		"outputs": [
			{
				"internalType": "contract IERC20",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "tokenPrice",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "tokenURI",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "newOwner",
				"type": "address"
			}
		],
		"name": "transferOwnership",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "withdrawTokens",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	}
];
        const contractAddress1 = 0x1b3e2c3F880273Fd3E9bd59B320697a0E172bebf;

        async function connect() {
    if (window.ethereum) {
        try {
            await window.ethereum.request({ method: 'eth_requestAccounts' });
            web3 = new Web3(window.ethereum);
            accounts = await web3.eth.getAccounts();
            const balance = await web3.eth.getBalance(accounts[0]);
            document.getElementById("balance").innerHTML = "Balance: " + balance / 1e18 + " SGB";

            contract = new web3.eth.Contract(abi1, contractAddress1);

            await displayUserBalance();
        } catch (error) {
            console.error(error);
        }
    } else {
        console.error("MetaMask not detected.");
    }
}
async function mint() {
            try {
                await contract.methods.mintNFT(accounts[0]).send({ from: accounts[0] });
            } catch (error) {
                console.error(error);
            }
        }
        const abi = 
        [
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "depositGuigzToken",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "depositWSGB",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "_GuigzToken",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "_WSGB",
				"type": "address"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "withdrawGuigzToken",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "amount",
				"type": "uint256"
			}
		],
		"name": "withdrawWSGB",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "balancesGuigzToken",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"name": "balancesWSGB",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "GuigzToken",
		"outputs": [
			{
				"internalType": "contract IERC20",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "WSGB",
		"outputs": [
			{
				"internalType": "contract IERC20",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]
const contractAddress = "0xF1e3C3B9716b6A154A8DA74968A847C71e04438C";

async function connect() {
    if (window.ethereum) {
        try {
            await window.ethereum.request({ method: 'eth_requestAccounts' });
            web3 = new Web3(window.ethereum);
            accounts = await web3.eth.getAccounts();
            const balance = await web3.eth.getBalance(accounts[0]);
            document.getElementById("balancesWSGB").innerHTML = "balancesWSGB: " + balance / 1e18 + " SGB";

            contract = new web3.eth.Contract(abi, contractAddress);

            await displayUserBalance();
        } catch (error) {
            console.error(error);
        }
    } else {
        console.error("MetaMask not detected.");
    }
}

async function displayUserBalance() {
	if (accounts && accounts[0]) {
		const userBalance = await web3.eth.getBalance(accounts[0]);
		const userBalanceInEther = web3.utils.fromWei(userBalance, "ether");
		document.getElementById("balances").innerText = `Solde : ${userBalanceInEther} ETH`;
	} else {
		document.getElementById("balances").innerText = "Solde : 0 ETH";
	}
}
async function depositGuigzToken() {
            const amount = document.getElementById("guigzAmount").value;
            const amountInWei = web3.utils.toWei(amount, 'ether');
            await contract.methods.depositGuigzToken(amountInWei).send({ from: accounts[0] });
        }

        async function withdrawGuigzToken() {
            const amount = document.getElementById("guigzAmount").value;
            const amountInWei = web3.utils.toWei(amount, 'ether');
            await contract.methods.withdrawGuigzToken(amountInWei).send({ from: accounts[0] });
        }

        async function depositWSGB() {
            const amount = document.getElementById("wsgbAmount").value;
            const amountInWei = web3.utils.toWei(amount, 'ether');
            await contract.methods.depositWSGB(amountInWei).send({ from: accounts[0] });
        }

        async function withdrawWSGB() {
            const amount = document.getElementById("wsgbAmount").value;
            const amountInWei = web3.utils.toWei(amount, 'ether');
            await contract.methods.withdrawWSGB(amountInWei).send({ from: accounts[0] });
        }

        async function loadBlockchainData() {
    const web3 = new Web3(Web3.givenProvider || "http://localhost:8545");
    const accounts = await web3.eth.getAccounts();
    const networkId = await web3.eth.net.getId();

    const tokenDepositWithdraw = new web3.eth.Contract(
        abi,
        contractAddress
    );

    const WSGBBalance = await tokenDepositWithdraw.methods.balancesWSGB(accounts[0]).call();
    const GuigzTokenBalance = await tokenDepositWithdraw.methods.balancesGuigzToken(accounts[0]).call();

    document.getElementById("balancesWSGB").innerText = `WSGB Balance: ${WSGBBalance}`;
    document.getElementById("balancesGuigzToken").innerText = `GuigzToken Balance: ${GuigzTokenBalance}`;
}

        document.getElementById("connect").addEventListener("click", connect);
        document.getElementById("mint").addEventListener("click", mint);
        document.getElementById("depositGuigzToken").addEventListener("click", depositGuigzToken);
        document.getElementById("withdrawGuigzToken").addEventListener("click", withdrawGuigzToken);
        document.getElementById("depositWSGB").addEventListener("click", depositWSGB);
        document.getElementById("withdrawWSGB").addEventListener("click", withdrawWSGB);
    </script>
    <div id="balancesWSGB"></div>
    <div id="balancesGuigzToken"></div>
</body>
</html>
